{"data":{"children":[{"children":[{"content":"text/html; charset=UTF-8","http-equiv":"Content-Type","tag":"meta"},{"content":"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui","name":"viewport","tag":"meta"},{"src":"cashier-card-validate.js","tag":"script"},{"children":[{"tag":"text","text":"var is_flybird = navigator.userAgent.toLowerCase().indexOf(\"flybird\")>=0;//### 是否为飞鸟引擎\nvar is_android = navigator.userAgent.toLowerCase().indexOf(\"android\")>=0;//### 是否为android平台\nvar path = is_android ? \"com.alipay.android.app/\" : \"AlipaySDK.bundle/\";\nvar arrow_left_png = path + \"arrow_left.png\";\nvar xie_line_png = path + \"xie_line.png\";\nvar loading_blue_gif = path + \"loading_blue.gif\";\nvar success_blue_norepeat_gif = path + \"success_blue_norepeat.gif\";\n\nvar p_array = new Array();\n\nfunction init() {\n    document.querySelector(\"#arrow_left_png\").src = arrow_left_png;\n    document.querySelector(\"#xie_line\").src = xie_line_png;\n    document.getElementById('date_input').focus();\n    \n    p_array = document.querySelectorAll(\"p\");\n\n\n\tif(is_android){\n\t\tvar pclick = function(){\n\t\t\tvar input = document.getElementById('date_input');\n\t\t\tinput.focus();\n\t\t}\n\t\t\n\t\tdocument.getElementById(\"p0\").onclick = pclick;\n\t\tdocument.getElementById(\"p1\").onclick = pclick;\n\t\tdocument.getElementById(\"p2\").onclick = pclick;\n\t\tdocument.getElementById(\"p3\").onclick = pclick;\n\n\t}\n\n}\n\n//###\nfunction onSelect(){\n    setTimeout(submit,1000);\n}\n\n\n//### 支付成功\nfunction onpay_success()\n{\n    if(is_android){\n\t\tdocument.getElementById('pwd_load_gif').showPaySuccess();\n\t} else {\n\t\tdocument.getElementById('pwd_load_gif').src = success_blue_norepeat_gif;\n\t}\n    document.getElementById('pwd_load_text').innerText = '付款成功';\n}\n\n\n//### 提交\nfunction submit(){\n    var obj = {\"action\":{\n        \"name\":\"/cashier/cardValidate\",\n        \"host\":flybird.rpcData.pci_url,\n        \"https\":true,\n        \"neec\" : \"6004\",\n        \"loadtxt\" : \"\",\n        \"enctype\": \"application/x-www-form-urlencoded\",\n        \"request_param\":\"requestData\"\n    }};\n    var submit_obj = {\"validate\":document.getElementById('date_input').value};\n    obj[\"param\"] = submit_obj;\n    \n    ant.asyncSubmit(obj, function(data) {\n        //### 支付成功\n        if (data[\"status\"] == \"0001\") {\n            onpay_success();\n        }\n        //### 信息输入错误\n        else if (data[\"status\"] == \"0000\") {\n        \tdocument.getElementById('date_input').value = \"\";\n        \tdocument.getElementById('date_input').focus();\n            if(is_android){\n\t\t\t    document.getElementById('pwd_load_gif').pauseProgressWheel();    \t\n        \t} else {\n\t        \tdocument.getElementById('pwd_load_gif').src = \"\";\n        \t}\n    \t\tdocument.getElementById('pwd_load').style.display = \"none\";\n    \t\tonDateInput();\n        }\n    });\n    \n    document.getElementById('date_input').blur();\n     if(is_android){\n\t\tdocument.getElementById('pwd_load_gif').showProgressWheel();    \t\n\t} else {\n    \tdocument.getElementById('pwd_load_gif').src = loading_blue_gif;;\n\t}\n    document.getElementById('pwd_load').style.display = \"-webkit-box\";\n}\n\n\n//### 返回\nfunction onBack() {\n    var dialogObj = {\n            message: '确定要退出吗',\n            okButton: '确定',\n            cancelButton: '取消'\n        };\n        ant.confirm(dialogObj, function (result) {\n            if (result.ok) {\n                ant.submit({\"action\":{\"name\":\"loc:exit\"}});\n            }\n            else {\n            \tvar input = document.getElementById('date_input');\n\t\t\t\tinput.focus();\n            }\n        });\n}\n\nfunction onDateInput() {\n\tvar input = document.getElementById('date_input');\n\tvar text = input.value;\n\t\n\tfor (var i = 0; i <  4; i++) {\n\t\tp_array[i].innerText = \"\";\n\t}\n\t\n\tfor (var i = 0; i < text.length && i < 4; i++) {\n\t\tp_array[i].innerText = text.substr(i, 1);\n\t}\n\t\n\tif (text.length >= 4) {\n\t\tinput.value = text.substr(0, 4);\n\t\tsubmit();\n\t}\n}"}],"tag":"script"},{"href":"AlipaySDK.bundle/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"tag":"style"}],"tag":"head"},{"children":[{"children":[{"children":[{"id":"arrow_left_png","tag":"img"}],"css":"common_immersion_title_left_box","onclick":"onBack()","tag":"div"},{"children":[{"children":[{"tag":"text","text":"输入有效期"}],"css":"common_immersion_title_center_text","id":"title","tag":"label"}],"css":"common_immersion_title_center_box","tag":"div"},{"css":"common_immersion_title_right_box","tag":"div"}],"css":"common_immersion_title_box","tag":"div"},{"css":"common_1px_title_line","tag":"div"},{"children":[{"children":[{"tag":"text","text":"请输入付款信用卡的有效期"}],"css":"cashier_card_validate_1","tag":"label"}],"css":"common_padding_top_bottom","style":"text-align:center;","tag":"div"},{"id":"date_input","keyboard":"safe","oninput":"onDateInput()","style":"width:0px; height:0px;","tag":"input","type":"num"},{"children":[{"children":[{"css":"num_item","id":"p0","tag":"p"},{"css":"num_line","tag":"div"},{"css":"num_item","id":"p1","tag":"p"}],"css":"common_box_flex num_box","style":"","tag":"div"},{"id":"xie_line","style":"padding:0px 15px;","tag":"img"},{"children":[{"css":"num_item","id":"p2","tag":"p"},{"css":"num_line","tag":"div"},{"css":"num_item","id":"p3","tag":"p"}],"css":"common_box_flex num_box","style":"","tag":"div"}],"css":"common_box_flex","style":"","tag":"div"},{},{"children":[{"css":"progresswheel","id":"pwd_load_gif","style":"width:55px; height:55px;","tag":"img"},{"children":[{"children":[{"tag":"text","text":"正在付款..."}],"css":"open_pwd_check_4","id":"pwd_load_text","tag":"label"}],"style":"text-align:center; padding-top:20px;","tag":"div"}],"id":"pwd_load","style":"display:none; -webkit-box-align:center; -webkit-box-orient:vertical; -webkit-box-pack:center; -webkit-box-flex:1.0;","tag":"div"}],"css":"common_immersion_body","id":"body","onkeydown":"onBack();","onload":"init()","tag":"body"}],"tag":"html"},"format":"JSON","name":"cashier-card-validate","publishVersion":"150604","tag":"QUICKPAY","time":"0047","tplId":"QUICKPAY@cashier-card-validate","tplVersion":"5.0.0"}